services:
  - type: web
    name: caritas-mcp-server
    runtime: python
    region: frankfurt  # Closest to Switzerland
    plan: free

    # Build configuration
    buildCommand: pip install -r requirements.txt
    startCommand: python server.py

    # Environment variables
    envVars:
      # FastMCP Authentication Configuration
      - key: FASTMCP_SERVER_AUTH
        value: fastmcp.server.auth.providers.jwt.JWTVerifier

      # Auth0 JWT Configuration - Set these in Render Dashboard
      - key: FASTMCP_SERVER_AUTH_JWT_AUDIENCE
        sync: false  # Must be set to: https://caritas-mcp-server.onrender.com

      - key: FASTMCP_SERVER_AUTH_JWT_ISSUER
        sync: false  # Must be set to: https://your-tenant.auth0.com/

      - key: FASTMCP_SERVER_AUTH_JWT_JWKS_URI
        sync: false  # Must be set to: https://your-tenant.auth0.com/.well-known/jwks.json

      - key: FASTMCP_SERVER_AUTH_JWT_ALGORITHM
        value: RS256

      # OpenAI Configuration - Set in Render Dashboard
      - key: OPENAI_API_KEY
        sync: false  # NEVER commit this - set manually in Render dashboard

      - key: OPENAI_MODEL
        value: gpt-4o-mini

      - key: OPENAI_MAX_TOKENS
        value: 4000

      # Python version
      - key: PYTHON_VERSION
        value: 3.11

    # Auto-deploy on git push
    autoDeploy: true

    # Health check
    healthCheckPath: /mcp